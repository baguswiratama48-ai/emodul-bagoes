import { createClient } from "https://esm.sh/@supabase/supabase-js@2";

const corsHeaders = {
  "Access-Control-Allow-Origin": "*",
  "Access-Control-Allow-Headers": "authorization, x-client-info, apikey, content-type",
};

// Data siswa kelas XI
const studentsXI = [
  // XI.3
  { nis: "13794", nisn: "0097611518", name: "ACHMAD ALFINO AFFANDI", kelas: "XI.3" },
  { nis: "13811", nisn: "0082289231", name: "AJENG LINTANGSARI", kelas: "XI.3" },
  { nis: "13819", nisn: "0098662033", name: "ALYA HOIRUNNISA", kelas: "XI.3" },
  { nis: "13822", nisn: "0092359568", name: "ALYCIA VEGA SAMANTHA", kelas: "XI.3" },
  { nis: "13835", nisn: "0098723708", name: "ANI ANTIKA SARI", kelas: "XI.3" },
  { nis: "13870", nisn: "0092250020", name: "BASITHU HARIFA", kelas: "XI.3" },
  { nis: "13894", nisn: "0085225363", name: "DESANDRA DWI NOLIA", kelas: "XI.3" },
  { nis: "13899", nisn: "0081241868", name: "DEVITA VIONA SIANTURI", kelas: "XI.3" },
  { nis: "13903", nisn: "0085290063", name: "DHINI ANGGRAINI", kelas: "XI.3" },
  { nis: "13905", nisn: "0099672773", name: "DIAN AYU PRAYUGI", kelas: "XI.3" },
  { nis: "13921", nisn: "0081205952", name: "ELSA AMELIA LUTHFIAH", kelas: "XI.3" },
  { nis: "13923", nisn: "003087757986", name: "ERISA ENJEL PRATIWI", kelas: "XI.3" },
  { nis: "13927", nisn: "0084368655", name: "FAHRI ADITYA PRATAMA", kelas: "XI.3" },
  { nis: "13932", nisn: "0094224286", name: "FANNIA SYIFA QONITA", kelas: "XI.3" },
  { nis: "13936", nisn: "0096087856", name: "FEBRIA RAHMAWATI", kelas: "XI.3" },
  { nis: "13944", nisn: "0081554137", name: "FITRIA SAKINAH", kelas: "XI.3" },
  { nis: "13965", nisn: "0095033550", name: "INTAN AULIA PARASTIWI", kelas: "XI.3" },
  { nis: "13967", nisn: "0099364164", name: "ISNA NUR KHOIRIYAH", kelas: "XI.3" },
  { nis: "13981", nisn: "0093789100", name: "KARINA", kelas: "XI.3" },
  { nis: "13993", nisn: "0097548535", name: "LEONY BRILIAN PUTRI PERMADANY", kelas: "XI.3" },
  { nis: "13996", nisn: "0095669910", name: "M BATARA ILHAM", kelas: "XI.3" },
  { nis: "13997", nisn: "0098499359", name: "M BRILIAN FAJAR AL AKBAR", kelas: "XI.3" },
  { nis: "13998", nisn: "003082127513", name: "M DHIAZ AKBAR NATANEGARA", kelas: "XI.3" },
  { nis: "14021", nisn: "00107484310", name: "MUH AR RASID RIZKI", kelas: "XI.3" },
  { nis: "14038", nisn: "0068550089611176", name: "NABILA OKTARIANI", kelas: "XI.3" },
  { nis: "14051", nisn: "0093986006", name: "NAZWA KIRENINA", kelas: "XI.3" },
  { nis: "14089", nisn: "0094607096", name: "REKY TEGAR PERMANA", kelas: "XI.3" },
  { nis: "14108", nisn: "0091999346", name: "RIZKY EFRIYANSAH", kelas: "XI.3" },
  { nis: "14110", nisn: "0093551276", name: "ROYCE LATHIFATUN NISSA", kelas: "XI.3" },
  { nis: "14121", nisn: "0099259167", name: "SEPTI PUTRI RAMADHANI", kelas: "XI.3" },
  { nis: "14126", nisn: "0095653769", name: "SHARLA DWI MEIDANIA", kelas: "XI.3" },
  { nis: "14145", nisn: "0096467365", name: "THALITA ARIF", kelas: "XI.3" },
  { nis: "14157", nisn: "0093618406", name: "VINA MAQFIROH", kelas: "XI.3" },
  { nis: "14201", nisn: "0092189528", name: "WAYAN FAREL SADEWA", kelas: "XI.3" },
  { nis: "14162", nisn: "0082786983", name: "WINDI NUR ALIYAH", kelas: "XI.3" },
  { nis: "14180", nisn: "0097445533", name: "ZAHROTUS SITA", kelas: "XI.3" },
  // XI.5
  { nis: "13798", nisn: "0096295340", name: "ADILAH FIZZA RAMADHANI", kelas: "XI.5" },
  { nis: "13800", nisn: "0087524892", name: "ADIVA ERJI NUGRAHA", kelas: "XI.5" },
  { nis: "13807", nisn: "003095714161", name: "AIRA KANZA ARDILA", kelas: "XI.5" },
  { nis: "13808", nisn: "0097014372", name: "AIRU MALIKA QUEEN JAUHARI", kelas: "XI.5" },
  { nis: "13832", nisn: "0097818090", name: "ANGGIE CAHYA WIJAYA", kelas: "XI.5" },
  { nis: "14191", nisn: "0094104460", name: "ANISA APRILIA (RUSDI)", kelas: "XI.5" },
  { nis: "13846", nisn: "0098148570", name: "ARUMI OCTARIA DEWI", kelas: "XI.5" },
  { nis: "13852", nisn: "0097554522", name: "AULIA NASHIFAH", kelas: "XI.5" },
  { nis: "13896", nisn: "0087650632", name: "DESMALITA LOVIKA", kelas: "XI.5" },
  { nis: "13897", nisn: "0089910235", name: "DESTI AYU ANGGRAINI", kelas: "XI.5" },
  { nis: "13898", nisn: "0091706927", name: "DESTRI BUNGA AZARIA", kelas: "XI.5" },
  { nis: "13900", nisn: "0083941390", name: "DEWI KUSUMA ASRI", kelas: "XI.5" },
  { nis: "13901", nisn: "0098859762", name: "DEXSA AFGAN JUNIYANTO", kelas: "XI.5" },
  { nis: "13917", nisn: "0094832831", name: "ECA RISDI LESTARI", kelas: "XI.5" },
  { nis: "13925", nisn: "0098011383", name: "FADEL MUHAMMAD", kelas: "XI.5" },
  { nis: "13951", nisn: "003093966083", name: "GASSEL ADITYA PRATAMA", kelas: "XI.5" },
  { nis: "13968", nisn: "0091601497", name: "JACKLYN RIVALDO PANKER", kelas: "XI.5" },
  { nis: "13972", nisn: "0095822790", name: "JESSICA DWIPA SARI", kelas: "XI.5" },
  { nis: "14030", nisn: "0091574413", name: "MUHAMMAD RADIF WINANTO", kelas: "XI.5" },
  { nis: "14031", nisn: "0089188539", name: "MUHAMMAD RIZQI MUBAROK", kelas: "XI.5" },
  { nis: "14050", nisn: "0091561012", name: "NAZWA AL ADIRA", kelas: "XI.5" },
  { nis: "14067", nisn: "0094087691", name: "POPY GRACIA BR MARBUN", kelas: "XI.5" },
  { nis: "14075", nisn: "0098669071", name: "RAFA NAUFAL RAMADHAN", kelas: "XI.5" },
  { nis: "14085", nisn: "0092543208", name: "RANIA ADELIA MORIN", kelas: "XI.5" },
  { nis: "14100", nisn: "0094096341", name: "RICHI MUNAYA PUTRI", kelas: "XI.5" },
  { nis: "14103", nisn: "0085523293", name: "RIFKI ALIFFIYANSYAH", kelas: "XI.5" },
  { nis: "14109", nisn: "0085722899", name: "RIZQIA BALQIS", kelas: "XI.5" },
  { nis: "14112", nisn: "0093667425", name: "SALSHA BILLA", kelas: "XI.5" },
  { nis: "14134", nisn: "0098018454", name: "SINTA MAULIA", kelas: "XI.5" },
  { nis: "14146", nisn: "0087655837", name: "THEON ABIEZA", kelas: "XI.5" },
  { nis: "14148", nisn: "0098303159", name: "TIARA RAMADHANI", kelas: "XI.5" },
  { nis: "14170", nisn: "0084103977", name: "YUDA PANDUWINATA", kelas: "XI.5" },
  { nis: "14173", nisn: "0083102227", name: "YURIKE KEYLILA PUTRI", kelas: "XI.5" },
  { nis: "14178", nisn: "0093745133", name: "ZAHRA AULIA RAHMAH", kelas: "XI.5" },
  { nis: "14184", nisn: "0093768200", name: "ZEIN NUR ANIFA", kelas: "XI.5" },
  { nis: "14185", nisn: "0096006477", name: "ZULVI ALFARID", kelas: "XI.5" },
  // XI.6
  { nis: "13795", nisn: "0091762077", name: "ADELIA MAHARANI", kelas: "XI.6" },
  { nis: "13801", nisn: "0089147518", name: "ADLY FIYARENSA", kelas: "XI.6" },
  { nis: "13815", nisn: "0088414877", name: "ALFUAD AKBAR", kelas: "XI.6" },
  { nis: "13827", nisn: "0095565894", name: "ANDITI SEKAR WANGI", kelas: "XI.6" },
  { nis: "14194", nisn: "0083198599", name: "CHELSI OLIVIA", kelas: "XI.6" },
  { nis: "13889", nisn: "0094123272", name: "DAMAR YUSUF WIJAYA", kelas: "XI.6" },
  { nis: "13891", nisn: "0096692379", name: "DAVINA SANLIA PUTRI", kelas: "XI.6" },
  { nis: "13911", nisn: "0097846336", name: "DINDA AMELIA KOLIN", kelas: "XI.6" },
  { nis: "13912", nisn: "0094212105", name: "DINDA ARUM AMELIA", kelas: "XI.6" },
  { nis: "13919", nisn: "0096500265", name: "EKA PUTRI PURNAMA SARI", kelas: "XI.6" },
  { nis: "13920", nisn: "0092464911", name: "ELISABETH GRECIA SAMOSIR", kelas: "XI.6" },
  { nis: "14190", nisn: "0091420226", name: "FLORA DZASKIA FEBRITASARI", kelas: "XI.6" },
  { nis: "13949", nisn: "0093760906", name: "GALIH ARJUN WIDIANATA", kelas: "XI.6" },
  { nis: "13960", nisn: "0092621670", name: "HUWAIDA NUR ZAHRA", kelas: "XI.6" },
  { nis: "13963", nisn: "0097141628", name: "IGNASIA VELLY JESVITA", kelas: "XI.6" },
  { nis: "13964", nisn: "0086638941", name: "INDRI NUR SETO", kelas: "XI.6" },
  { nis: "13969", nisn: "003085040462", name: "JAUVAN M DA'I", kelas: "XI.6" },
  { nis: "13974", nisn: "0096931496", name: "JOANI OGILVIE ALMANDITA CHRISTI", kelas: "XI.6" },
  { nis: "14001", nisn: "00108855518", name: "M GATHAN AL-FURQON DERU", kelas: "XI.6" },
  { nis: "14025", nisn: "0087005969", name: "MUHAMMAD FAHRI AL AKBAR", kelas: "XI.6" },
  { nis: "14034", nisn: "0091704818", name: "MUSYAFA RAMADHAN WINATA", kelas: "XI.6" },
  { nis: "14056", nisn: "0089925999", name: "NI WAYAN WIDANI", kelas: "XI.6" },
  { nis: "14060", nisn: "0083536269", name: "NOPIA MELINDA PUTRI", kelas: "XI.6" },
  { nis: "14063", nisn: "0084382021", name: "NURUL FITRIA NINGSIH", kelas: "XI.6" },
  { nis: "14069", nisn: "0094366170", name: "PRINCESS KHUMAIRAH OBERATIA", kelas: "XI.6" },
  { nis: "14074", nisn: "0095195730", name: "RADYA NAURA SYAFA", kelas: "XI.6" },
  { nis: "14082", nisn: "0085302679", name: "RAKA PRASETIO", kelas: "XI.6" },
  { nis: "14094", nisn: "0097142947", name: "RESTA LINA APRILIA", kelas: "XI.6" },
  { nis: "14105", nisn: "0091846888", name: "RISQUNNA MAHARANI", kelas: "XI.6" },
  { nis: "14127", nisn: "0086230840", name: "SHELA OKTAVIANA PUTRI", kelas: "XI.6" },
  { nis: "14135", nisn: "0082394593", name: "SITI KHARIZZA AFIFA AZZAHRA", kelas: "XI.6" },
  { nis: "14144", nisn: "0085736905", name: "TASYA SALSABILA", kelas: "XI.6" },
  { nis: "14158", nisn: "0097534265", name: "VIRLA VIVI APRILLIZIA", kelas: "XI.6" },
  { nis: "14161", nisn: "0097544797", name: "WAYAN ANA MURTI KARA TAMAR", kelas: "XI.6" },
  { nis: "14164", nisn: "0083420389", name: "YANUAR KEYZA AZZAHRA", kelas: "XI.6" },
  { nis: "14179", nisn: "0092147595", name: "ZAHRA SALSABELLA", kelas: "XI.6" },
  // XI.7
  { nis: "13799", nisn: "0091827925", name: "ADINDA LAURA CALLISTA", kelas: "XI.7" },
  { nis: "13803", nisn: "0093445614", name: "AGNESIA PRAHMADIA TYAS ASTUTI", kelas: "XI.7" },
  { nis: "13828", nisn: "0082327394", name: "ANDRI SOLEH SAPUTRA", kelas: "XI.7" },
  { nis: "13843", nisn: "0081892979", name: "ARKHA FAJARAHMAN", kelas: "XI.7" },
  { nis: "13849", nisn: "0098300657", name: "ASTRI KAFITA SODIN", kelas: "XI.7" },
  { nis: "13850", nisn: "0085807539", name: "ATHIRA DWI SYAWALIA", kelas: "XI.7" },
  { nis: "13857", nisn: "0084339361", name: "AULIYA NATASYA", kelas: "XI.7" },
  { nis: "13862", nisn: "0099163297", name: "AYSHA MAHARANI", kelas: "XI.7" },
  { nis: "13888", nisn: "0094345037", name: "DAFFA RAFID HAKIM", kelas: "XI.7" },
  { nis: "13904", nisn: "0096147258", name: "DIAN APRILLIA", kelas: "XI.7" },
  { nis: "13946", nisn: "0091069262", name: "FREDERICHA ZANNETHALIA NUGROHO", kelas: "XI.7" },
  { nis: "13952", nisn: "0092139004", name: "GISELLIN EKKLESIA AHYUTYAS", kelas: "XI.7" },
  { nis: "13953", nisn: "0087006329", name: "GLEDYS SHAFIRA", kelas: "XI.7" },
  { nis: "13962", nisn: "0093543288", name: "IBNU SABILLAL", kelas: "XI.7" },
  { nis: "13985", nisn: "0095714134", name: "KETUT BUNGA", kelas: "XI.7" },
  { nis: "14009", nisn: "0084619229", name: "MARVEL RIANTO", kelas: "XI.7" },
  { nis: "14010", nisn: "003091008303", name: "MAUDI MUNAZA", kelas: "XI.7" },
  { nis: "14019", nisn: "0098446157", name: "MONICA ROLA AGNESIA MARIS", kelas: "XI.7" },
  { nis: "14026", nisn: "0095409686", name: "MUHAMMAD HAFIS ARIDDHO", kelas: "XI.7" },
  { nis: "14029", nisn: "0091237136", name: "MUHAMMAD MIFTAH SYAMIL CANDRA", kelas: "XI.7" },
  { nis: "14047", nisn: "0096388415", name: "NAYLA DWI WENA ANJANI", kelas: "XI.7" },
  { nis: "14084", nisn: "0084308210", name: "RAMADHAN PRATAMA", kelas: "XI.7" },
  { nis: "14097", nisn: "0097065672", name: "REVIN RIDHO VRANZAS", kelas: "XI.7" },
  { nis: "14114", nisn: "0083169863", name: "SARWO", kelas: "XI.7" },
  { nis: "14118", nisn: "0091392071", name: "SEISYA RHANI", kelas: "XI.7" },
  { nis: "14122", nisn: "0097051704", name: "SEPTIA RAMADHANI", kelas: "XI.7" },
  { nis: "14125", nisn: "0092771186", name: "SHAFIQA LUTFUN NISA", kelas: "XI.7" },
  { nis: "14130", nisn: "0091902686", name: "SHIFA AULIA", kelas: "XI.7" },
  { nis: "14132", nisn: "0096137695", name: "SIFA ANTIKA", kelas: "XI.7" },
  { nis: "14133", nisn: "0093683402", name: "SILASTRI", kelas: "XI.7" },
  { nis: "14141", nisn: "0096703346", name: "SYAM ADLI NASAPUTRA", kelas: "XI.7" },
  { nis: "14155", nisn: "0099361791", name: "VIDIA KUSHERAWATI", kelas: "XI.7" },
  { nis: "14174", nisn: "0087677028", name: "YURISCA DINDA SEPTYANA", kelas: "XI.7" },
  { nis: "14175", nisn: "0087402697", name: "YUVANA MILYARIANI", kelas: "XI.7" },
  { nis: "14182", nisn: "0086987597", name: "ZAQIA ALENDIA", kelas: "XI.7" },
  // XI.8
  { nis: "13824", nisn: "0094165684", name: "AMEL LIANA", kelas: "XI.8" },
  { nis: "13840", nisn: "0097994848", name: "ARGA PRATAMA", kelas: "XI.8" },
  { nis: "13854", nisn: "0092036183", name: "AULIA RAMADHANI", kelas: "XI.8" },
  { nis: "13864", nisn: "0088380474", name: "AYU NURAIDA", kelas: "XI.8" },
  { nis: "13865", nisn: "0081769924", name: "AYU PUSPITA SARI", kelas: "XI.8" },
  { nis: "13866", nisn: "0095533593", name: "AYU PUTRI KIRANA", kelas: "XI.8" },
  { nis: "13883", nisn: "0084048511", name: "CHINTYA", kelas: "XI.8" },
  { nis: "13884", nisn: "0085261160", name: "CICILIA AYU PRAMUDISTA", kelas: "XI.8" },
  { nis: "13892", nisn: "0092492879", name: "DEA MARETA AZZAHRA", kelas: "XI.8" },
  { nis: "13902", nisn: "0087499149", name: "DHEA ANANDA RAMADHANI", kelas: "XI.8" },
  { nis: "13926", nisn: "0098269430", name: "FADHIL REMAZA ABDI", kelas: "XI.8" },
  { nis: "13935", nisn: "0083661599", name: "FATIMAH AZZAHRA GHAIDA ANI", kelas: "XI.8" },
  { nis: "13948", nisn: "0097006000", name: "GALANG PALAYUDA", kelas: "XI.8" },
  { nis: "13950", nisn: "0095171867", name: "GARIZA NUR ALTIFA", kelas: "XI.8" },
  { nis: "13956", nisn: "0087220818", name: "GUSTI AYU KETUT FITRIYANA", kelas: "XI.8" },
  { nis: "13957", nisn: "0094875189", name: "HAFIZZAH NUR AISIYAH", kelas: "XI.8" },
  { nis: "13973", nisn: "0087268757", name: "JIHAN NATASYA PUTRI", kelas: "XI.8" },
  { nis: "13977", nisn: "0088727493", name: "JUSMAN MANURUNG", kelas: "XI.8" },
  { nis: "14004", nisn: "0098576886", name: "M. FAHRI ALBANIA", kelas: "XI.8" },
  { nis: "14005", nisn: "0095824778", name: "M. GERHAN LANTARA", kelas: "XI.8" },
  { nis: "14014", nisn: "0093081066", name: "MEDINA DWI AULIA", kelas: "XI.8" },
  { nis: "14017", nisn: "0095048292", name: "MIA AFINA", kelas: "XI.8" },
  { nis: "14037", nisn: "0094174185", name: "NABIL ZUHRA", kelas: "XI.8" },
  { nis: "14045", nisn: "0094873540", name: "NAURAH AURELIA", kelas: "XI.8" },
  { nis: "14059", nisn: "0097177023", name: "NISYA AZAHRA", kelas: "XI.8" },
  { nis: "13700", nisn: "0084886912", name: "RAFI FIRMANSYAH", kelas: "XI.8" },
  { nis: "14079", nisn: "0096990708", name: "RAHMA AS SYIFA", kelas: "XI.8" },
  { nis: "14093", nisn: "0099753741", name: "RESHIFA ADELIA", kelas: "XI.8" },
  { nis: "14106", nisn: "0087605867", name: "RISTY ANGGRAINI", kelas: "XI.8" },
  { nis: "14107", nisn: "0097592034", name: "RIZAL GUSTI PUTRA", kelas: "XI.8" },
  { nis: "14117", nisn: "0091111102", name: "SAYYA CAHYANAKOPA", kelas: "XI.8" },
  { nis: "14153", nisn: "0088935584", name: "VARRA AMELIA RAMADHANI", kelas: "XI.8" },
  { nis: "14160", nisn: "0099793285", name: "VISKA SIRIN SUMAYYAH", kelas: "XI.8" },
  { nis: "14166", nisn: "0093645038", name: "YOAN DAFRIZA", kelas: "XI.8" },
  { nis: "14176", nisn: "003085321380", name: "ZAFIRA FAIRUS AURELLIA RAMADHANI", kelas: "XI.8" },
  { nis: "14181", nisn: "0087049765", name: "ZALFA PUTRI OLVITA", kelas: "XI.8" },
  // XI.9
  { nis: "13796", nisn: "0098398759", name: "ADELIYA MAHARANI", kelas: "XI.9" },
  { nis: "13805", nisn: "00109352013", name: "AHMAD RIZKY MAULANA RIDO", kelas: "XI.9" },
  { nis: "13810", nisn: "0097734994", name: "AJEB YUDHA", kelas: "XI.9" },
  { nis: "13818", nisn: "0099643361", name: "ALVINO ANGLING AHMARSYAH", kelas: "XI.9" },
  { nis: "13837", nisn: "0086523906", name: "ANJANI PUTRI WIJAYA", kelas: "XI.9" },
  { nis: "13848", nisn: "0095899059", name: "ARYA SYAROF BASUKI", kelas: "XI.9" },
  { nis: "13851", nisn: "0093476386", name: "AULIA MAHARANI", kelas: "XI.9" },
  { nis: "13860", nisn: "0085940174", name: "AUREL HAREN SAPUTRI", kelas: "XI.9" },
  { nis: "13890", nisn: "0088502663", name: "DANIS ARGA PURNAMA", kelas: "XI.9" },
  { nis: "13909", nisn: "0096343938", name: "DINA AMELIA", kelas: "XI.9" },
  { nis: "13934", nisn: "0074577364", name: "FATHIR AL'FAIZ", kelas: "XI.9" },
  { nis: "13938", nisn: "0094959766", name: "FEBRIANI SAPUTRI", kelas: "XI.9" },
  { nis: "13947", nisn: "00104494637", name: "FRISKA OKTAVIANI", kelas: "XI.9" },
  { nis: "13978", nisn: "0084063511", name: "JUWITA APRILLIA", kelas: "XI.9" },
  { nis: "14003", nisn: "0082077978", name: "M KHADAFFY AL KHAWARIZMI", kelas: "XI.9" },
  { nis: "14193", nisn: "0093179127", name: "MUHAMMAD ILHAM PANDU", kelas: "XI.9" },
  { nis: "14027", nisn: "0083265817", name: "MUHAMMAD IQBAL MUZAKI", kelas: "XI.9" },
  { nis: "14028", nisn: "0099477704", name: "MUHAMMAD KHEYKO AL-GAZALI", kelas: "XI.9" },
  { nis: "14048", nisn: "0091841008", name: "NAYRA AFRYANEVA", kelas: "XI.9" },
  { nis: "14053", nisn: "0096851656", name: "NAZWA SALSABILA", kelas: "XI.9" },
  { nis: "14065", nisn: "0093717653", name: "PETRA ELSA TANUJAYA", kelas: "XI.9" },
  { nis: "14070", nisn: "003098060782", name: "PRISCELIA CAHYA KEMILA", kelas: "XI.9" },
  { nis: "14071", nisn: "0085116894", name: "PUTRI AULIA", kelas: "XI.9" },
  { nis: "14073", nisn: "0086775675", name: "PUTRI OKTARINA", kelas: "XI.9" },
  { nis: "14077", nisn: "0093825805", name: "RAFIKA DWI MELATI", kelas: "XI.9" },
  { nis: "14078", nisn: "0094676757", name: "RAHMA AMELIA", kelas: "XI.9" },
  { nis: "14086", nisn: "0093773069", name: "RANTIKA KUSUMA DEWI", kelas: "XI.9" },
  { nis: "14088", nisn: "0096104379", name: "RATU MARTA LIANA", kelas: "XI.9" },
  { nis: "14090", nisn: "0097554284", name: "RENCY ZAHRA ASSYIFA", kelas: "XI.9" },
  { nis: "14091", nisn: "0092153278", name: "RENTAULI VALENROUS SIHOMBING", kelas: "XI.9" },
  { nis: "14099", nisn: "0089761824", name: "RHISTY AGUSTINA", kelas: "XI.9" },
  { nis: "14113", nisn: "0099246059", name: "SALWA RIZKIA AF", kelas: "XI.9" },
  { nis: "14147", nisn: "0092843993", name: "TIARA RAHAYU", kelas: "XI.9" },
  { nis: "14163", nisn: "0095112847", name: "YAHYA", kelas: "XI.9" },
  { nis: "14169", nisn: "00960385999", name: "YOLANDA ARTUR PUTRI", kelas: "XI.9" },
  { nis: "14172", nisn: "0086410729", name: "YURIKA DIMA SARI", kelas: "XI.9" },
  // XI.10
  { nis: "14200", nisn: "0088702922", name: "ADIRA AHMAD NUGRAHA", kelas: "XI.10" },
  { nis: "13804", nisn: "0092533605", name: "AHMAD INDRA JAUHARI", kelas: "XI.10" },
  { nis: "13806", nisn: "0097715160", name: "AIDHA SHAFA KHOERUNISA", kelas: "XI.10" },
  { nis: "13820", nisn: "0091590837", name: "ALYA NAFISA", kelas: "XI.10" },
  { nis: "13829", nisn: "0092923514", name: "ANEIRA NURMA ZALIA", kelas: "XI.10" },
  { nis: "13834", nisn: "0091582775", name: "ANGGUN PUTRI ASYIRAH", kelas: "XI.10" },
  { nis: "13844", nisn: "0093136226", name: "ARRAUUF GUSTIAR PULAPI", kelas: "XI.10" },
  { nis: "13845", nisn: "0095003600", name: "ARUM MAHAYATI", kelas: "XI.10" },
  { nis: "13847", nisn: "0098504821", name: "ARYA HANIF SAPUTRA", kelas: "XI.10" },
  { nis: "13853", nisn: "0089811399", name: "AULIA RAMADHANI", kelas: "XI.10" },
  { nis: "13858", nisn: "0095593472", name: "AURA ALLEN CANTIKA", kelas: "XI.10" },
  { nis: "13871", nisn: "0098671880", name: "BERA MEIDIANA", kelas: "XI.10" },
  { nis: "13874", nisn: "0098228478", name: "BUNGA MAHARANI", kelas: "XI.10" },
  { nis: "13879", nisn: "0099776226", name: "CHARISHA PUTRI", kelas: "XI.10" },
  { nis: "13906", nisn: "0091484330", name: "DIFA RAISA PUTRA", kelas: "XI.10" },
  { nis: "13918", nisn: "0083590924", name: "EDSEL ANDREYANTO", kelas: "XI.10" },
  { nis: "13922", nisn: "0089675366", name: "EPANLI OKSYA AL FAKHRI", kelas: "XI.10" },
  { nis: "13933", nisn: "0095531805", name: "FANNY FAZRIA ANDINI", kelas: "XI.10" },
  { nis: "13937", nisn: "0099684934", name: "FEBRIANA", kelas: "XI.10" },
  { nis: "13954", nisn: "0099183626", name: "GRACIA VANIA PRADITA", kelas: "XI.10" },
  { nis: "13961", nisn: "0096353245", name: "HUWAIDA NUR ZAHWA", kelas: "XI.10" },
  { nis: "13992", nisn: "0093375183", name: "KRISTINA AJENG SETIARINI", kelas: "XI.10" },
  { nis: "14007", nisn: "0085484994", name: "MARIA TRI PURWANINGSIH", kelas: "XI.10" },
  { nis: "14013", nisn: "0098817411", name: "MAYA SABRINA ALZAHRA", kelas: "XI.10" },
  { nis: "14023", nisn: "0082045410", name: "MUHAMMAD AFDAL NUGRAHA", kelas: "XI.10" },
  { nis: "13652", nisn: "0088205541", name: "MUHAMMAD KHADAFI", kelas: "XI.10" },
  { nis: "14036", nisn: "0091990240", name: "MUZACKY ABDULLAH", kelas: "XI.10" },
  { nis: "14042", nisn: "0094425233", name: "NADYA ANDINI", kelas: "XI.10" },
  { nis: "14052", nisn: "0089033276", name: "NAZWA PUTRI CANTIKA", kelas: "XI.10" },
  { nis: "14064", nisn: "0085146767", name: "PEBBY ZAHWA NURUL AULIA", kelas: "XI.10" },
  { nis: "14092", nisn: "0098516828", name: "RERA CHANTIKA ZEMMA", kelas: "XI.10" },
  { nis: "14137", nisn: "0097375398", name: "STEVINA SEYSA", kelas: "XI.10" },
  { nis: "14195", nisn: "0097973460", name: "SYIFA AZZAHRA", kelas: "XI.10" },
  { nis: "14149", nisn: "0096415461", name: "TINANTI MORLINA", kelas: "XI.10" },
  { nis: "14165", nisn: "0095892631", name: "YENSI DEBY TRIARTA", kelas: "XI.10" },
  // XI.11
  { nis: "13793", nisn: "0094440199", name: "A. GERHIN LANTARA", kelas: "XI.11" },
  { nis: "13802", nisn: "0085963648", name: "AFTIRA ISMALA PUTRI", kelas: "XI.11" },
  { nis: "13809", nisn: "0096529374", name: "AISYAH MAULINA ZUSA", kelas: "XI.11" },
  { nis: "13812", nisn: "0082053044", name: "AKNES DWI NOVELISA", kelas: "XI.11" },
  { nis: "13813", nisn: "0082714678", name: "AL VIERA OLYVIA", kelas: "XI.11" },
  { nis: "13821", nisn: "0095853064", name: "ALYAA' NABIILAH", kelas: "XI.11" },
  { nis: "13823", nisn: "0097208928", name: "AMANDA AYUNI PUTRI", kelas: "XI.11" },
  { nis: "13831", nisn: "0096205443", name: "ANGELINA FITRIA", kelas: "XI.11" },
  { nis: "13838", nisn: "0099584896", name: "ANNISA DIAN YUDANTO", kelas: "XI.11" },
  { nis: "13841", nisn: "0094111355", name: "ARILLA SEPTIA RAMADHANI", kelas: "XI.11" },
  { nis: "13855", nisn: "0094390852", name: "AULIA VIRGIN MEILITA", kelas: "XI.11" },
  { nis: "13881", nisn: "0098985576", name: "CHIARA PALOMA SETYA", kelas: "XI.11" },
  { nis: "13914", nisn: "0093651402", name: "DION NAEK MARCELLO", kelas: "XI.11" },
  { nis: "14594", nisn: "0096278490", name: "ELVHA RESTA ASWINRAHMADINI", kelas: "XI.11" },
  { nis: "13924", nisn: "0091230092", name: "ETNESSIUS YUDHA SIH PRESENTIO", kelas: "XI.11" },
  { nis: "13931", nisn: "0092824707", name: "FAKHRI ALBARRA AHMAD", kelas: "XI.11" },
  { nis: "14192", nisn: "0093861138", name: "GALEN FADIL ANGGARA", kelas: "XI.11" },
  { nis: "13958", nisn: "001470098666410", name: "HARYO BAGAS WICAKSONO", kelas: "XI.11" },
  { nis: "13975", nisn: "0092912456", name: "JOICE MAY NANDA", kelas: "XI.11" },
  { nis: "13982", nisn: "0092278395", name: "KAYLA RURI APRILIA", kelas: "XI.11" },
  { nis: "13990", nisn: "00167990087330999", name: "KHANZA DIAH PARAMITA", kelas: "XI.11" },
  { nis: "13994", nisn: "0098308354", name: "LIRA AMELDA JULYANI", kelas: "XI.11" },
  { nis: "14006", nisn: "0097313197", name: "M.FEBRI LOGA FERNANDO", kelas: "XI.11" },
  { nis: "14011", nisn: "0093880888", name: "MAULIDA SARAH AZARIA", kelas: "XI.11" },
  { nis: "14018", nisn: "0093355348", name: "MIA DWI YUSMARETA SARI", kelas: "XI.11" },
  { nis: "14055", nisn: "0092020452", name: "NEIHA DARA ANJANI", kelas: "XI.11" },
  { nis: "14066", nisn: "0091671504", name: "PINDA TITIAN INSANI", kelas: "XI.11" },
  { nis: "14087", nisn: "0083738876", name: "RASYID AL AJI", kelas: "XI.11" },
  { nis: "14138", nisn: "0098655748", name: "SUCI SETIA MUKTI", kelas: "XI.11" },
  { nis: "14140", nisn: "0096980562", name: "SYAKIRA HANISA", kelas: "XI.11" },
  { nis: "14150", nisn: "0083416546", name: "TIO PRATAMA", kelas: "XI.11" },
  { nis: "14151", nisn: "0081340988", name: "TIRTA ADI KUSUMA", kelas: "XI.11" },
  { nis: "14156", nisn: "0094666123", name: "VINA AYUDEA", kelas: "XI.11" },
  { nis: "14167", nisn: "00108352502", name: "YOAN VERINDRI", kelas: "XI.11" },
  { nis: "14171", nisn: "0093950189", name: "YULIANA", kelas: "XI.11" },
];

Deno.serve(async (req) => {
  if (req.method === "OPTIONS") {
    return new Response(null, { headers: corsHeaders });
  }

  try {
    const supabaseUrl = Deno.env.get("SUPABASE_URL")!;
    const serviceRoleKey = Deno.env.get("SUPABASE_SERVICE_ROLE_KEY")!;
    
    const supabase = createClient(supabaseUrl, serviceRoleKey, {
      auth: {
        autoRefreshToken: false,
        persistSession: false,
      },
    });

    const results: { success: string[]; failed: string[] } = {
      success: [],
      failed: [],
    };

    // Create student accounts for class XI
    for (const student of studentsXI) {
      const email = `${student.nisn}@siswa.local`;
      const password = student.nis;

      const { data, error } = await supabase.auth.admin.createUser({
        email,
        password,
        email_confirm: true,
        user_metadata: {
          full_name: student.name,
          role: "siswa",
        },
      });

      if (error) {
        results.failed.push(`${student.name} (${student.nisn}): ${error.message}`);
      } else {
        // Update profile with NIS and kelas
        if (data.user) {
          const { error: profileError } = await supabase
            .from('profiles')
            .update({ nis: student.nis, kelas: student.kelas })
            .eq('id', data.user.id);
          
          if (profileError) {
            results.failed.push(`${student.name} profile update: ${profileError.message}`);
          } else {
            results.success.push(`${student.name}: NISN=${student.nisn}, NIS=${student.nis}, Kelas=${student.kelas}`);
          }
        }
      }
    }

    return new Response(
      JSON.stringify({
        message: "Seeding XI students completed",
        totalSuccess: results.success.length,
        totalFailed: results.failed.length,
        results,
      }),
      {
        headers: { ...corsHeaders, "Content-Type": "application/json" },
        status: 200,
      }
    );
  } catch (error: unknown) {
    const message = error instanceof Error ? error.message : "Unknown error";
    return new Response(
      JSON.stringify({ error: message }),
      {
        headers: { ...corsHeaders, "Content-Type": "application/json" },
        status: 500,
      }
    );
  }
});
